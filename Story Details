STRY0937491 - SAM Data Source - Enable IRE:
--------------------------------------------------------------------------------------
vz_server_sam: Data source

SELECT [assetid]
      ,[source]
      ,[devicename]
      ,[physical_virtual]
      ,[fqdn]
      ,[status]
      ,[manufacturer]
      ,[serialnumber]
      ,[decommissionDate]
      ,[cpucount]
      ,[corecount]
      ,[cpuspeed]
      ,[os]
      ,[osversion]
      ,[Environment]
      ,[businessunit]
      ,[assetsupportlevel]
      ,[discovery_source]
      ,[model_id]
      ,[app]
      ,[BC]
      ,[custodianeid]
      ,[DirectorEID]
      ,[appl_ref]
      ,[ostype]
      ,[locationcode]
      ,[LastUpdateDate]
      ,[Type]
  FROM [ServiceNow].[SAM]
  WHERE (
        ([Type] <> 'IMAGING/VIDEO DEVICES' OR [Type] IS NULL) AND [status] <> 'Retired' AND ([Manufacturer] IS NULL OR [Manufacturer] <> 'Software House')
                     ) OR (
        ([Type] <> 'IMAGING/VIDEO DEVICES' OR [Type] IS NULL) AND [status] = 'Retired' AND [LastUpdateDate]>GETDATE()-90 AND ([Manufacturer] IS NULL OR [Manufacturer] <> 'Software House')
                     )

Acceptance criteria:
Bring the TYPE only if it is one of:
Only bring in items with TYPE =
SERVERS
VIRTUAL GUEST
VIRTUAL MACHINE
VMWARE ESX SERVER
BLADE ENCLOSURES
SOLARIS GLOBAL ZONE
SOLARIS LDOM
SOLARIS NON-GLOBAL ZONE
SOLARIS FRAME DOMAIN
RACK ENCLOSURES

1) the SAM data source vz_servers_SAM is filtered to only bring in the list of Type values in the description & where either:
status is not retired
status is retired & last update was in the last 90 days

Answer:

SELECT [assetid]
      ,[source]
      ,[devicename]
      ,[physical_virtual]
      ,[fqdn]
      ,[status]
      ,[manufacturer]
      ,[serialnumber]
      ,[decommissionDate]
      ,[cpucount]
      ,[corecount]
      ,[cpuspeed]
      ,[os]
      ,[osversion]
      ,[Environment]
      ,[businessunit]
      ,[assetsupportlevel]
      ,[discovery_source]
      ,[model_id]
      ,[app]
      ,[BC]
      ,[custodianeid]
      ,[DirectorEID]
      ,[appl_ref]
      ,[ostype]
      ,[locationcode]
      ,[LastUpdateDate]
      ,[Type]
FROM [ServiceNow].[SAM]
WHERE [Type] IN (
    'SERVERS',
    'VIRTUAL GUEST',
    'VIRTUAL MACHINE',
    'VMWARE ESX SERVER',
    'BLADE ENCLOSURES',
    'SOLARIS GLOBAL ZONE',
    'SOLARIS LDOM',
    'SOLARIS NON-GLOBAL ZONE',
    'SOLARIS FRAME DOMAIN',
    'RACK ENCLOSURES'
)
AND (
    ([status] <> 'Retired')
    OR
    ([status] = 'Retired' AND [LastUpdateDate] > GETDATE() - 90)
)
AND (
    [Manufacturer] IS NULL OR [Manufacturer] <> 'Software House'
)
----------------------------------------------------------------------------
vz_servers_SAM_delta: Data source
SQL Statement:
SELECT [assetid]
      ,[source]
      ,[devicename]
      ,[physical_virtual]
      ,[fqdn]
      ,[status]
      ,[manufacturer]
      ,[serialnumber]
      ,[decommissionDate]
      ,[cpucount]
      ,[corecount]
      ,[cpuspeed]
      ,[os]
      ,[osversion]
      ,[Environment]
      ,[businessunit]
      ,[assetsupportlevel]
      ,[discovery_source]
      ,[model_id]
      ,[app]
      ,[BC]
      ,[custodianeid]
      ,[DirectorEID]
      ,[appl_ref]
      ,[ostype]
      ,[locationcode]
      ,[LastUpdateDate]
  FROM [ServiceNow].[SAM]
WHERE ([Type] <> 'IMAGING/VIDEO DEVICES' OR [Type] IS NULL) AND ([Manufacturer] IS NULL OR [Manufacturer] <> 'Software House')

2) the SAM data source vz_servers_SAM_delta is filtered to only bring in the list of Type values in the description & where status is not retired

Answer:

SELECT [assetid]
      ,[source]
      ,[devicename]
      ,[physical_virtual]
      ,[fqdn]
      ,[status]
      ,[manufacturer]
      ,[serialnumber]
      ,[decommissionDate]
      ,[cpucount]
      ,[corecount]
      ,[cpuspeed]
      ,[os]
      ,[osversion]
      ,[Environment]
      ,[businessunit]
      ,[assetsupportlevel]
      ,[discovery_source]
      ,[model_id]
      ,[app]
      ,[BC]
      ,[custodianeid]
      ,[DirectorEID]
      ,[appl_ref]
      ,[ostype]
      ,[locationcode]
      ,[LastUpdateDate]
      ,[Type]
FROM [ServiceNow].[SAM]
WHERE [Type] IN (
    'SERVERS',
    'VIRTUAL GUEST',
    'VIRTUAL MACHINE',
    'VMWARE ESX SERVER',
    'BLADE ENCLOSURES',
    'SOLARIS GLOBAL ZONE',
    'SOLARIS LDOM',
    'SOLARIS NON-GLOBAL ZONE',
    'SOLARIS FRAME DOMAIN',
    'RACK ENCLOSURES'
)
AND [status] <> 'Retired'
AND ([Manufacturer] IS NULL OR [Manufacturer] <> 'Software House')

